= Introduction =

PortalGun is the fabfi mesh network access controller. 


== Bump OpenWRT iptables to 1.4.12.1 ==

The standard iptables in OpenWRT backfire & trunk does not include support for the tproxy modules we need to redirect client requests to the portal splash page or transparent proxy.

  * Edit: package/iptables/Makefile
  {{{
  #PKG_VERSION:=1.4.10
  PKG_VERSION:=1.4.12.1

  #PKG_MD5SUM:=f382fe693f0b59d87bd47bea65eca198
  PKG_MD5SUM:=b08a1195ec2c1ebeaf072db3c55fdf43
  }}}

  * Run:   TODO update patches for 1.4.12.1
  {{{
  rm package/iptables/patches/010-multiport-linux-2.4-compat.patch
  rm package/iptables/patches/011-recent-add-reap.patch
  rm package/iptables/patches/020-iptables-disable-modprobe.patch
  rm package/iptables/patches/100-bash-location.patch
  }}}


== Package Compilation ==

  * Edit: feeds.conf.default
  {{{
  src-svn fabfi http://fabfi.googlecode.com/svn/trunk/openwrt/package-scripts
  src-svn afrimesh http://afrimesh.googlecode.com/svn/trunk/package-scripts/openwrt
  }}}

  * Run:
  {{{
  ./scripts/feeds update fabfi afrimesh
  ./scripts/feeds/install portalgun

  make menuconfig

      Network -> Captive Portals -> portalgun 

  make
  }}}


== Installation == 

  * Run:
  {{{
  opkg install portalgun
  uci add_list lucid.httpd.supports=VillagebusPublisher
  uci add_list lucid.https.publisher=villagebus
  uci set lucid.villagebus=VillagebusPublisher
  uci set lucid.villagebus.name="Villagebus Publisher"
  uci set lucid.villagebus.home=1
  uci add_list lucid.villagebus.virtual=/villagebus
  }}}

== Configuration ==


== Hacking == 